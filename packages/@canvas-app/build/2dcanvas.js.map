{"version":3,"file":"2dcanvas.js","mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;ACVa;AACb;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,oBAAoB,GAAG,sCAAsC,GAAG,mCAAmC;AACnG,mCAAmC;AACnC;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,oBAAoB;;;;;;;;;;;ACrGP;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D,cAAc;AACd,aAAa,mBAAO,CAAC,gDAAQ;AAC7B;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,cAAc;;;;;;;;;;;AC7DD;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D,YAAY;AACZ,aAAa,mBAAO,CAAC,gDAAQ;AAC7B;AACA;AACA;AACA;AACA,wBAAwB,YAAY;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,YAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sBAAsB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,YAAY;;;;;;;;;;;AClHC;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D,YAAY;AACZ,aAAa,mBAAO,CAAC,gDAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,YAAY;;;;;;;;;;;AChEC;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,uBAAuB;AACvB,qCAAqC,mBAAO,CAAC,6DAA0B;AACvE,cAAc,mBAAO,CAAC,8CAAS;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,gCAAgC;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,6BAA6B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,6BAA6B;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,QAAQ;AACjF;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,uBAAuB;;;;;;;;;;;AClSV;AACb;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,aAAa,GAAG,mCAAmC,GAAG,oBAAoB;AAC1E,uBAAuB,mBAAO,CAAC,uEAAyB;AACxD;AACA;AACA;AACA;AACA,CAAC,0CAA0C,oBAAoB,KAAK;AACpE,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,QAAQ;AAClE;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,+BAA+B;AAC/B,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C,2BAA2B,+CAA+C;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,QAAQ;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,qCAAqC;AACrC;AACA;AACA,wBAAwB,wBAAwB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA,iDAAiD,QAAQ;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,aAAa;;;;;;;;;;;ACzOA;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,qBAAqB;AACrB;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,qBAAqB;;;;;;;;;;;ACvER;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,oDAAoD,yBAAyB,KAAK;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACD,kBAAe;;;;;;;UCpCf;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;;;ACtBa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,yBAAyB,mBAAO,CAAC,0EAA0B;AAC3D,eAAe,mBAAO,CAAC,8DAAoB;AAC3C,aAAa,mBAAO,CAAC,0DAAkB;AACvC,aAAa,mBAAO,CAAC,0DAAkB;AACvC,kBAAe;AACf;AACA;AACA;AACA;AACA;AACA,KAAK;AACL","sources":["webpack://canvas-app/webpack/universalModuleDefinition","webpack://canvas-app/./lib/2dcanvas/Geometies/Base.ts","webpack://canvas-app/./lib/2dcanvas/Geometies/Circle.ts","webpack://canvas-app/./lib/2dcanvas/Geometies/Line.ts","webpack://canvas-app/./lib/2dcanvas/Geometies/Rect.ts","webpack://canvas-app/./lib/2dcanvas/Scene/CanvasController.ts","webpack://canvas-app/./lib/2dcanvas/Scene/Scene.ts","webpack://canvas-app/./lib/2dcanvas/Tools/BoxSelect.Tool.ts","webpack://canvas-app/./lib/utils/Events.class.ts","webpack://canvas-app/webpack/bootstrap","webpack://canvas-app/./lib/2dcanvas/main.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn ","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.GeometryBase = exports.DEFAULT_HIGHLIGHT_DRAW_SETTING = exports.DEFAULT_NORMAL_DRAW_SETTING = void 0;\r\nexports.DEFAULT_NORMAL_DRAW_SETTING = {\r\n    fillStyle: 'rgba(255, 255, 0, 1)',\r\n    lineWidth: 1,\r\n    strokeStyle: 'rgba(0, 0, 0, 1)',\r\n};\r\nexports.DEFAULT_HIGHLIGHT_DRAW_SETTING = {\r\n    strokeStyle: 'rgba(255, 0, 0, 255)',\r\n    lineWidth: 5,\r\n    fillStyle: 'rgba(255, 255, 255, 1)',\r\n};\r\nvar GeometryBase = /** @class */ (function () {\r\n    function GeometryBase() {\r\n        this.brushConfig = {\r\n            normal: exports.DEFAULT_NORMAL_DRAW_SETTING,\r\n            highlight: exports.DEFAULT_HIGHLIGHT_DRAW_SETTING,\r\n        };\r\n        this.highlight = false;\r\n        this.checked = false;\r\n        this.index = -1;\r\n        this.id = null;\r\n    }\r\n    GeometryBase.prototype.setNormalPaintStyle = function (options) {\r\n        this.brushConfig.normal = __assign(__assign({}, this.brushConfig.normal), options);\r\n    };\r\n    GeometryBase.prototype.setHighlightPaintStyle = function (options) {\r\n        this.brushConfig.highlight = __assign(__assign({}, this.brushConfig.highlight), options);\r\n    };\r\n    GeometryBase.prototype.getPaintStyle = function () {\r\n        return this.isHighlight() ? this.brushConfig.highlight : this.brushConfig.normal;\r\n    };\r\n    GeometryBase.prototype.setShapeParameter = function (x, y) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.setAssistSetting = function (options) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.moveTo = function (x, y) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.moveDist = function (distX, distY) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.choose = function (x, y) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.getOffset = function (x, y) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.draw = function (ctx) {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.validate = function () {\r\n        /* ... */\r\n    };\r\n    GeometryBase.prototype.setIndex = function (index) {\r\n        if (index === void 0) { index = -1; }\r\n        this.index = index;\r\n    };\r\n    GeometryBase.prototype.getIndex = function () {\r\n        return this.index;\r\n    };\r\n    GeometryBase.prototype.setChecked = function () {\r\n        this.checked = true;\r\n    };\r\n    GeometryBase.prototype.setUnChecked = function () {\r\n        this.checked = false;\r\n    };\r\n    GeometryBase.prototype.isChecked = function () {\r\n        return this.checked;\r\n    };\r\n    GeometryBase.prototype.setHighlight = function () {\r\n        this.highlight = true;\r\n    };\r\n    GeometryBase.prototype.setUnHighlight = function () {\r\n        this.highlight = false;\r\n    };\r\n    GeometryBase.prototype.isHighlight = function () {\r\n        return this.highlight;\r\n    };\r\n    GeometryBase.prototype.setId = function (id) {\r\n        this.id = id;\r\n    };\r\n    GeometryBase.prototype.getId = function () {\r\n        return this.id;\r\n    };\r\n    return GeometryBase;\r\n}());\r\nexports.GeometryBase = GeometryBase;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Circle = void 0;\r\nvar Base_1 = require(\"./Base\");\r\nvar Circle = /** @class */ (function (_super) {\r\n    __extends(Circle, _super);\r\n    function Circle(x, y, r) {\r\n        if (r === void 0) { r = 0; }\r\n        var _this = _super.call(this) || this;\r\n        _this.x = x;\r\n        _this.y = y;\r\n        _this.r = r;\r\n        return _this;\r\n    }\r\n    Circle.prototype.setShapeParameter = function (x, y) {\r\n        this.r = Math.sqrt(Math.pow(this.x - x, 2) + Math.pow(this.y - y, 2));\r\n    };\r\n    Circle.prototype.moveDist = function (distX, distY) {\r\n        this.x += distX;\r\n        this.y += distY;\r\n    };\r\n    Circle.prototype.getOffset = function (x, y) {\r\n        return {\r\n            distX: x - this.x,\r\n            distY: y - this.y,\r\n        };\r\n    };\r\n    Circle.prototype.choose = function (x, y) {\r\n        return Math.pow(this.x - x, 2) + Math.pow(this.y - y, 2) < Math.pow(this.r, 2);\r\n    };\r\n    Circle.prototype.draw = function (ctx) {\r\n        var brushConfig = this.getPaintStyle();\r\n        ctx.beginPath();\r\n        ctx.fillStyle = brushConfig.fillStyle;\r\n        ctx.strokeStyle = brushConfig.strokeStyle;\r\n        ctx.lineWidth = brushConfig.lineWidth;\r\n        ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);\r\n        ctx.stroke();\r\n        ctx.fill();\r\n        ctx.closePath();\r\n    };\r\n    Circle.prototype.validate = function () {\r\n        return this.r >= 5;\r\n    };\r\n    return Circle;\r\n}(Base_1.GeometryBase));\r\nexports.Circle = Circle;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Line = void 0;\r\nvar Base_1 = require(\"./Base\");\r\nvar Line = /** @class */ (function (_super) {\r\n    __extends(Line, _super);\r\n    function Line(x, y) {\r\n        var _this = _super.call(this) || this;\r\n        _this.path = [{ x: x, y: y }];\r\n        _this.smooth = false;\r\n        _this.lineWidth = 10;\r\n        _this.samplingIntervalNumber = 2;\r\n        return _this;\r\n    }\r\n    Line.prototype.setShapeParameter = function (x, y) {\r\n        var lastPoint = this.path[this.path.length - 1];\r\n        if (Math.abs(lastPoint.x - x) > 1 || Math.abs(lastPoint.y - y) > 1) {\r\n            this.path.push({ x: x, y: y });\r\n        }\r\n    };\r\n    Line.prototype.setAssistSetting = function (setting) {\r\n        if (typeof setting.smooth !== 'undefined') {\r\n            this.smooth = !!setting.smooth;\r\n        }\r\n    };\r\n    Line.prototype.moveTo = function (x, y) {\r\n        var startPoint = this.path[0];\r\n        var startPoinTGeometryOffsetX = x - startPoint.x;\r\n        var startPoinTGeometryOffsetY = y - startPoint.y;\r\n        for (var i = 0; i < this.path.length; i++) {\r\n            this.path[i].x += startPoinTGeometryOffsetX;\r\n            this.path[i].y += startPoinTGeometryOffsetY;\r\n        }\r\n    };\r\n    Line.prototype.moveDist = function (distX, distY) {\r\n        for (var i = 0; i < this.path.length; i++) {\r\n            this.path[i].x += distX;\r\n            this.path[i].y += distY;\r\n        }\r\n    };\r\n    Line.prototype.choose = function (x, y) {\r\n        var round = this.lineWidth > 10 ? Math.pow(this.lineWidth, 2) : 30;\r\n        for (var i = 0; i < this.path.length; i++) {\r\n            if (Math.pow(this.path[i].x - x, 2) + Math.pow(this.path[i].y - y, 2) < round) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Line.prototype.getOffset = function (x, y) {\r\n        return {\r\n            distX: x - this.path[0].x,\r\n            distY: y - this.path[0].y,\r\n        };\r\n    };\r\n    Line.prototype.draw = function (ctx) {\r\n        var brushConfig = this.getPaintStyle();\r\n        ctx.fillStyle = \"rgba(0, 0, 0, 0)\";\r\n        ctx.strokeStyle = brushConfig.strokeStyle;\r\n        ctx.lineWidth = brushConfig.lineWidth;\r\n        ctx.lineJoin = 'round';\r\n        /*\r\n            非平滑曲线\r\n         */\r\n        if (!this.smooth) {\r\n            ctx.beginPath();\r\n            for (var i = 0; i < this.path.length; i++) {\r\n                ctx.lineTo(this.path[i].x, this.path[i].y);\r\n            }\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n            return;\r\n        }\r\n        if (this.path.length > 3) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(this.path[0].x, this.path[0].y);\r\n            var i = 1;\r\n            // let samplingIntervalNumber: number = this.path.length >= this.samplingIntervalNumber ? this.samplingIntervalNumber : 1\r\n            for (i = 1; i < this.path.length - 2; i += this.samplingIntervalNumber) {\r\n                if (this.path[i] && this.path[i + 1]) {\r\n                    var xc = (this.path[i].x + this.path[i + 1].x) / 2;\r\n                    var yc = (this.path[i].y + this.path[i + 1].y) / 2;\r\n                    ctx.quadraticCurveTo(this.path[i].x, this.path[i].y, xc, yc);\r\n                }\r\n            }\r\n            if (i >= this.path.length - 2) {\r\n                i = this.path.length - 2;\r\n            }\r\n            ctx.quadraticCurveTo(this.path[i].x, this.path[i].y, this.path[i + 1].x, this.path[i + 1].y);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n            return;\r\n        }\r\n    };\r\n    Line.prototype.validate = function () {\r\n        return this.path.length >= 5;\r\n    };\r\n    return Line;\r\n}(Base_1.GeometryBase));\r\nexports.Line = Line;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Rect = void 0;\r\nvar Base_1 = require(\"./Base\");\r\nvar Rect = /** @class */ (function (_super) {\r\n    __extends(Rect, _super);\r\n    function Rect(x, y, w, h) {\r\n        var _this = _super.call(this) || this;\r\n        _this.x = x;\r\n        _this.y = y;\r\n        _this.w = w;\r\n        _this.h = h;\r\n        return _this;\r\n    }\r\n    Rect.prototype.setShapeParameter = function (x, y) {\r\n        this.w = x - this.x;\r\n        this.h = y - this.y;\r\n    };\r\n    Rect.prototype.moveDist = function (distX, distY) {\r\n        this.x += distX;\r\n        this.y += distY;\r\n    };\r\n    Rect.prototype.getOffset = function (x, y) {\r\n        return {\r\n            distX: x - this.x,\r\n            distY: y - this.y,\r\n        };\r\n    };\r\n    Rect.prototype.choose = function (x, y) {\r\n        var absoluteMiddleX = this.x + this.w / 2;\r\n        var absoluteMiddleY = this.y + this.h / 2;\r\n        return Math.abs(x - absoluteMiddleX) < Math.abs(this.w / 2) && Math.abs(y - absoluteMiddleY) < Math.abs(this.h / 2);\r\n    };\r\n    Rect.prototype.draw = function (ctx) {\r\n        var brushConfig = this.getPaintStyle();\r\n        ctx.beginPath();\r\n        ctx.fillStyle = brushConfig.fillStyle;\r\n        ctx.strokeStyle = brushConfig.strokeStyle;\r\n        ctx.lineWidth = brushConfig.lineWidth;\r\n        ctx.rect(this.x, this.y, this.w, this.h);\r\n        ctx.stroke();\r\n        ctx.fill();\r\n        ctx.closePath();\r\n    };\r\n    Rect.prototype.validate = function () {\r\n        return Math.abs(this.w) >= 5 && Math.abs(this.h) >= 5;\r\n    };\r\n    return Rect;\r\n}(Base_1.GeometryBase));\r\nexports.Rect = Rect;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.CanvasContoller = void 0;\r\nvar Events_class_1 = __importDefault(require(\"../../utils/Events.class\"));\r\nvar Scene_1 = require(\"./Scene\");\r\nvar KEYCODE_DELETE = 46;\r\nvar KEYCODE_CTRL = 17;\r\nvar CanvasContoller = /** @class */ (function (_super) {\r\n    __extends(CanvasContoller, _super);\r\n    function CanvasContoller(canvasElement) {\r\n        var _this = _super.call(this, canvasElement) || this;\r\n        _this.variablesPool;\r\n        _this.eventsHandler;\r\n        _this.mouseWheelEventHandler = _this.mouseWheelEventHandler.bind(_this);\r\n        return _this;\r\n    }\r\n    CanvasContoller.prototype.init = function () {\r\n        this.variablesPool = {};\r\n        this.eventsHandler = new Events_class_1.default();\r\n        this.initScene();\r\n        this.initCanvasContoller();\r\n    };\r\n    CanvasContoller.prototype.initCanvasContoller = function () {\r\n        this.bindRightClickEvent();\r\n        this.bindMousedownEvent();\r\n        this.bindMousemoveEvent();\r\n        this.bindMouseupEvent();\r\n        this.bindMouseWheelEvent();\r\n        this.bindKeydownEvent();\r\n        this.bindKeyupEvent();\r\n        this.bindBlurEvent();\r\n    };\r\n    CanvasContoller.prototype.isOnlyCtrlKeydown = function () {\r\n        return this.keyboardState.keys.length === 1 && this.keyboardState.keys[0] === KEYCODE_CTRL;\r\n    };\r\n    CanvasContoller.prototype.bindRightClickEvent = function () {\r\n        this.canvasElement.addEventListener('contextmenu', function (evte) {\r\n            // evte.preventDefault()\r\n        });\r\n    };\r\n    CanvasContoller.prototype.bindMousedownEvent = function () {\r\n        var _this = this;\r\n        this.canvasElement.addEventListener('mousedown', function (evte) {\r\n            evte.stopPropagation();\r\n            _this.mouseState.down = true;\r\n            _this.mouseState.x = evte.offsetX;\r\n            _this.mouseState.y = evte.offsetY;\r\n            Promise.resolve().then(function () {\r\n                if (evte.button !== 0) {\r\n                    return;\r\n                }\r\n                /* 绘制模式 */\r\n                if (_this.config.state === Scene_1.ECanvasState.DRAWING) {\r\n                    _this.mouseState.selectedIndexs = [];\r\n                    /* 创建图形实例 */\r\n                    if (_this.geometryConstructor) {\r\n                        _this.variablesPool.geometryTarget = new _this.geometryConstructor(_this.mouseState.x, _this.mouseState.y);\r\n                        // this.variablesPool.geometryTarget.setNormalPaintStyle(this.toolState.paintBrushState)\r\n                        _this.variablesPool.geometryTarget.setAssistSetting({ smooth: _this.toolState.smooth });\r\n                    }\r\n                    /* 将新创建的实例标注为鼠标动态跟踪对象  */\r\n                    _this.mouseState.pointTarget = _this.variablesPool.geometryTarget;\r\n                    _this.variablesPool.geometryTarget = null;\r\n                    /* 重绘离屏画布 */\r\n                    _this.clearCanvas(_this.offScreen.cacheCanvasCtx);\r\n                    for (var i = 0; i < _this.geometries.length; i++) {\r\n                        _this.geometries[i].setUnHighlight();\r\n                        _this.geometries[i].setUnChecked();\r\n                        _this.geometries[i].draw(_this.offScreen.cacheCanvasCtx);\r\n                    }\r\n                    /* ... */\r\n                    _this.config.dirty = true;\r\n                    return;\r\n                }\r\n                /* 选择模式 */\r\n                if (_this.config.state === Scene_1.ECanvasState.SELECT) {\r\n                    /* 查询当前鼠标点击时被选中的几何图元 */\r\n                    _this.variablesPool.targetResult = _this.findClickedTarget(_this.mouseState.x, _this.mouseState.y);\r\n                    if (!_this.variablesPool.targetResult.geometryTarget) {\r\n                        /*\r\n                            未选中任何几何图元\r\n                                将所有几何图元取消高亮\r\n                                将鼠标状态修改为\"框选工具\"状态\r\n                         */\r\n                        _this.mouseState.selectedIndexs = [];\r\n                        for (var i = 0; i < _this.geometries.length; i++) {\r\n                            _this.geometries[i].setUnChecked();\r\n                            _this.geometries[i].setUnHighlight();\r\n                        }\r\n                        _this.mouseState.toolTarget = _this.tools.boxSelector;\r\n                        _this.mouseState.toolTarget.setStartCoordinate(_this.mouseState.x, _this.mouseState.y);\r\n                    }\r\n                    else {\r\n                        var inIndex = _this.mouseState.selectedIndexs.indexOf(_this.variablesPool.targetResult.geometryTargetIndex);\r\n                        if (_this.mouseState.selectedIndexs.length >= 2 && inIndex >= 0) {\r\n                            /* 选中了处于被选中状态的几何图元 */\r\n                            if (_this.isOnlyCtrlKeydown()) {\r\n                                _this.mouseState.selectedIndexs.splice(inIndex, 1);\r\n                                _this.variablesPool.targetResult.geometryTarget.setUnChecked();\r\n                                _this.variablesPool.targetResult.geometryTarget.setUnHighlight();\r\n                            }\r\n                        }\r\n                        else {\r\n                            if (_this.isOnlyCtrlKeydown()) {\r\n                                /* (仅)按住 Ctrl 键时交替删除/增加该选中的几何图元 */\r\n                                if (inIndex >= 0) {\r\n                                    _this.mouseState.selectedIndexs.splice(inIndex, 1);\r\n                                    _this.variablesPool.targetResult.geometryTarget.setUnChecked();\r\n                                    _this.variablesPool.targetResult.geometryTarget.setUnHighlight();\r\n                                }\r\n                                else {\r\n                                    _this.mouseState.selectedIndexs.push(_this.variablesPool.targetResult.geometryTargetIndex);\r\n                                    _this.variablesPool.targetResult.geometryTarget.setChecked();\r\n                                    _this.variablesPool.targetResult.geometryTarget.setHighlight();\r\n                                }\r\n                            }\r\n                            else {\r\n                                /* 设置仅选中当前被选中的几何图元 */\r\n                                _this.mouseState.selectedIndexs = [_this.variablesPool.targetResult.geometryTargetIndex];\r\n                                for (var i = 0; i < _this.geometries.length; i++) {\r\n                                    if (_this.mouseState.selectedIndexs[0] === i) {\r\n                                        continue;\r\n                                    }\r\n                                    _this.geometries[i].setUnChecked();\r\n                                    _this.geometries[i].setUnHighlight();\r\n                                }\r\n                                _this.variablesPool.targetResult.geometryTarget.setChecked();\r\n                                _this.variablesPool.targetResult.geometryTarget.setHighlight();\r\n                            }\r\n                        }\r\n                    }\r\n                    /* 重绘离屏画布 */\r\n                    _this.clearCanvas(_this.offScreen.cacheCanvasCtx);\r\n                    for (var i = 0; i < _this.geometries.length; i++) {\r\n                        if (_this.mouseState.selectedIndexs.includes(i)) {\r\n                            continue;\r\n                        }\r\n                        _this.geometries[i].draw(_this.offScreen.cacheCanvasCtx);\r\n                    }\r\n                    /* ... */\r\n                    _this.config.dirty = true;\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CanvasContoller.prototype.bindMousemoveEvent = function () {\r\n        var _this = this;\r\n        document.addEventListener('mousemove', function (evte) {\r\n            evte.stopPropagation();\r\n            if (!_this.mouseState.down || _this.isOnlyCtrlKeydown()) {\r\n                return;\r\n            }\r\n            if (evte.clientX - _this.config.canvasRect.left <= 0 ||\r\n                evte.clientY - _this.config.canvasRect.top <= 0 ||\r\n                evte.clientX >= _this.config.canvasRect.right ||\r\n                evte.clientY >= _this.config.canvasRect.bottom) {\r\n                return;\r\n            }\r\n            _this.variablesPool.moveDistX = evte.offsetX - _this.mouseState.x;\r\n            _this.variablesPool.moveDistY = evte.offsetY - _this.mouseState.y;\r\n            _this.mouseState.x = evte.offsetX;\r\n            _this.mouseState.y = evte.offsetY;\r\n            _this.mouseState.isMove = true;\r\n            /* 绘制模式 */\r\n            if (_this.config.state === Scene_1.ECanvasState.DRAWING && _this.mouseState.pointTarget) {\r\n                _this.mouseState.pointTarget.setShapeParameter(_this.mouseState.x, _this.mouseState.y);\r\n            }\r\n            /* 选择模式 */\r\n            if (_this.config.state === Scene_1.ECanvasState.SELECT) {\r\n                if (_this.mouseState.toolTarget) {\r\n                    _this.mouseState.toolTarget.setShapeParameter(_this.mouseState.x, _this.mouseState.y);\r\n                }\r\n                for (var i = _this.mouseState.selectedIndexs.length - 1; i >= 0; i--) {\r\n                    var geometry = _this.geometries[_this.mouseState.selectedIndexs[i]];\r\n                    geometry.moveDist(_this.variablesPool.moveDistX, _this.variablesPool.moveDistY);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    CanvasContoller.prototype.bindMouseupEvent = function () {\r\n        var _this = this;\r\n        document.addEventListener('mouseup', function (evte) {\r\n            evte.stopPropagation();\r\n            if (_this.mouseState.down) {\r\n                _this.mouseState.isMove = false;\r\n                _this.mouseState.down = false;\r\n                /* 绘制模式 */\r\n                if (_this.config.state === Scene_1.ECanvasState.DRAWING && _this.mouseState.pointTarget) {\r\n                    /* 将当前图形推入存储队列 */\r\n                    if (_this.mouseState.pointTarget.validate()) {\r\n                        _this.mouseState.pointTarget.setIndex(_this.geometries.length);\r\n                        _this.geometries.push(_this.mouseState.pointTarget);\r\n                    }\r\n                    _this.mouseState.pointTarget = null;\r\n                    /* 重绘离屏画布 */\r\n                    _this.clearCanvas(_this.offScreen.cacheCanvasCtx);\r\n                    for (var i = 0; i < _this.geometries.length; i++) {\r\n                        _this.geometries[i].draw(_this.offScreen.cacheCanvasCtx);\r\n                    }\r\n                    /* ... */\r\n                    _this.config.dirty = false;\r\n                    return;\r\n                }\r\n                /* 选择模式 */\r\n                if (_this.config.state === Scene_1.ECanvasState.SELECT) {\r\n                    if (_this.mouseState.toolTarget) {\r\n                        _this.mouseState.toolTarget.restoreStatus();\r\n                        _this.mouseState.toolTarget = null;\r\n                        _this.clearCanvas(_this.canvasCtx);\r\n                        /* 读取缓存画布图像并绘制输出 */\r\n                        _this.paintWith(_this.canvasCtx, _this.offScreen.cacheCanvasElement);\r\n                    }\r\n                    _this.mouseState.pointTarget = null;\r\n                    /* ... */\r\n                    _this.config.dirty = false;\r\n                }\r\n            }\r\n        });\r\n    };\r\n    CanvasContoller.prototype.bindMouseWheelEvent = function () {\r\n        this.canvasElement.addEventListener('mousewheel', this.mouseWheelEventHandler);\r\n        this.canvasElement.addEventListener('DOMMouseScroll', this.mouseWheelEventHandler);\r\n    };\r\n    CanvasContoller.prototype.bindBlurEvent = function () {\r\n        var _this = this;\r\n        window.addEventListener('blur', function (evte) {\r\n            _this.keyboardState.keys = [];\r\n            _this.config.dirty = false;\r\n        });\r\n    };\r\n    CanvasContoller.prototype.bindKeydownEvent = function () {\r\n        var _this = this;\r\n        document.addEventListener('keydown', function (evte) {\r\n            if (!_this.keyboardState.keys.includes(evte.keyCode)) {\r\n                _this.keyboardState.keys.push(evte.keyCode);\r\n            }\r\n            /* 删除图形对象 */\r\n            if (evte.keyCode === KEYCODE_DELETE && _this.mouseState.selectedIndexs.length) {\r\n                var geometries = [];\r\n                for (var i = 0; i < _this.geometries.length; i++) {\r\n                    if (!_this.mouseState.selectedIndexs.includes(i)) {\r\n                        geometries.push(_this.geometries[i]);\r\n                    }\r\n                }\r\n                _this.geometries = geometries;\r\n                _this.clearCanvas(_this.offScreen.cacheCanvasCtx);\r\n                for (var i = 0; i < _this.geometries.length; i++) {\r\n                    _this.geometries[i].draw(_this.offScreen.cacheCanvasCtx);\r\n                }\r\n                _this.config.dirty = true;\r\n                _this.mouseState.selectedIndexs = [];\r\n            }\r\n        });\r\n    };\r\n    CanvasContoller.prototype.bindKeyupEvent = function () {\r\n        var _this = this;\r\n        document.addEventListener('keyup', function (evte) {\r\n            var opKeyIndex = _this.keyboardState.keys.indexOf(evte.keyCode);\r\n            if (opKeyIndex >= 0) {\r\n                _this.keyboardState.keys.splice(opKeyIndex, 1);\r\n            }\r\n            if (!_this.mouseState.down && !_this.keyboardState.keys.length) {\r\n                _this.config.dirty = false;\r\n            }\r\n        });\r\n    };\r\n    CanvasContoller.prototype.mouseWheelEventHandler = function (evte) {\r\n        evte.preventDefault();\r\n        console.log(evte);\r\n    };\r\n    return CanvasContoller;\r\n}(Scene_1.Scene));\r\nexports.CanvasContoller = CanvasContoller;\r\n","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Scene = exports.DEFAULT_CANVAS_DRAW_SETTING = exports.ECanvasState = void 0;\r\nvar BoxSelect_Tool_1 = require(\"../Tools/BoxSelect.Tool\");\r\nvar ECanvasState;\r\n(function (ECanvasState) {\r\n    ECanvasState[\"DRAWING\"] = \"DRAWING\";\r\n    ECanvasState[\"SELECT\"] = \"SELECT\";\r\n})(ECanvasState = exports.ECanvasState || (exports.ECanvasState = {}));\r\nexports.DEFAULT_CANVAS_DRAW_SETTING = {\r\n    strokeStyle: '#000000',\r\n    fillStyle: '#ffff00',\r\n    lineWidth: 2,\r\n};\r\nvar Scene = /** @class */ (function () {\r\n    function Scene(canvasElement) {\r\n        if (!canvasElement || canvasElement.nodeName.toUpperCase() !== 'CANVAS') {\r\n            throw new Error(\"target dom must be a canvas element.\");\r\n        }\r\n        this.geometryConstructor;\r\n        this.geometries;\r\n        this.config;\r\n        this.tools;\r\n        this.toolState;\r\n        this.mouseState;\r\n        this.keyboardState;\r\n        this.offScreen;\r\n        this.canvasCtx;\r\n        this.canvasElement = canvasElement;\r\n    }\r\n    Scene.prototype.initScene = function () {\r\n        this.bindWindowResizeEvent();\r\n        this.geometryConstructor = null;\r\n        this.geometries = [];\r\n        this.config = {\r\n            state: ECanvasState.DRAWING,\r\n            canvasRect: this.createCanvasRect(),\r\n            dirty: false,\r\n            reDrawByResizeTimer: null,\r\n        };\r\n        this.tools = this.initTools();\r\n        this.toolState = this.initToolState();\r\n        this.mouseState = this.initMouseState();\r\n        this.keyboardState = this.initKeyboardState();\r\n        this.offScreen = this.createOffScreenCanvas();\r\n        this.canvasCtx = this.canvasElement.getContext('2d');\r\n        this.setCanvasElementRect();\r\n        this.continuedRender();\r\n    };\r\n    Scene.prototype.bindWindowResizeEvent = function () {\r\n        var _this = this;\r\n        window.addEventListener('resize', function (evte) {\r\n            window.clearTimeout(_this.config.reDrawByResizeTimer);\r\n            _this.config.reDrawByResizeTimer = window.setTimeout(function () {\r\n                _this.config.canvasRect = _this.createCanvasRect();\r\n                _this.setCanvasElementRect();\r\n                /* 重绘输出画布 */\r\n                _this.clearCanvas(_this.canvasCtx);\r\n                for (var i = _this.geometries.length - 1; i >= 0; i--) {\r\n                    _this.geometries[i].draw(_this.canvasCtx);\r\n                }\r\n            }, 300);\r\n        });\r\n    };\r\n    Scene.prototype.setCanvasElementRect = function (rect) {\r\n        if (rect === void 0) { rect = {}; }\r\n        var canvasRect = __assign(__assign({}, this.config.canvasRect), rect);\r\n        this.canvasElement.tabIndex = 0;\r\n        this.canvasElement.width = canvasRect.width;\r\n        this.canvasElement.height = canvasRect.height;\r\n        this.offScreen.cacheCanvasElement.width = canvasRect.width;\r\n        this.offScreen.cacheCanvasElement.height = canvasRect.height;\r\n    };\r\n    Scene.prototype.initToolState = function () {\r\n        var paintBrushState = __assign({}, exports.DEFAULT_CANVAS_DRAW_SETTING);\r\n        return {\r\n            paintBrushState: paintBrushState,\r\n            smooth: false,\r\n        };\r\n    };\r\n    Scene.prototype.initTools = function () {\r\n        var boxSelector = new BoxSelect_Tool_1.BoxSelectTool(0, 0, 0, 0);\r\n        return {\r\n            boxSelector: boxSelector,\r\n        };\r\n    };\r\n    Scene.prototype.initMouseState = function () {\r\n        return {\r\n            x: -1,\r\n            y: -1,\r\n            targetOffsetX: 0,\r\n            targetOffsetY: 0,\r\n            selectedIndexs: [],\r\n            down: false,\r\n            pointTarget: null,\r\n            toolTarget: null,\r\n            isMove: false,\r\n        };\r\n    };\r\n    Scene.prototype.initKeyboardState = function () {\r\n        return {\r\n            keys: [],\r\n        };\r\n    };\r\n    Scene.prototype.createCanvasRect = function () {\r\n        var domRect = this.canvasElement.getBoundingClientRect();\r\n        return domRect.toJSON();\r\n    };\r\n    Scene.prototype.createOffScreenCanvas = function () {\r\n        var cacheCanvasElement = document.createElement('canvas');\r\n        var offScreen = {\r\n            cacheCanvasElement: cacheCanvasElement,\r\n            cacheCanvasCtx: cacheCanvasElement.getContext('2d'),\r\n        };\r\n        /*\r\n            测试\r\n         */\r\n        // const tc1 = document.getElementById(`t_c_1`)\r\n        // tc1 && (() => { tc1.innerHTML = '' })()\r\n        // tc1 && (() => { tc1.appendChild(offScreen.cacheCanvasElement) })()\r\n        return offScreen;\r\n    };\r\n    Scene.prototype.continuedRender = function () {\r\n        var _this = this;\r\n        window.requestAnimationFrame(function () {\r\n            if (!_this.config.dirty) {\r\n                _this.continuedRender();\r\n                return;\r\n            }\r\n            _this.clearCanvas(_this.canvasCtx);\r\n            /* 读取缓存画布图像并绘制输出 */\r\n            _this.paintWith(_this.canvasCtx, _this.offScreen.cacheCanvasElement);\r\n            if (_this.mouseState.toolTarget) {\r\n                _this.mouseState.toolTarget.draw(_this.canvasCtx);\r\n            }\r\n            if (_this.mouseState.pointTarget) {\r\n                _this.mouseState.pointTarget.draw(_this.canvasCtx);\r\n            }\r\n            for (var i = _this.mouseState.selectedIndexs.length - 1; i >= 0; i--) {\r\n                var geometry = _this.geometries[_this.mouseState.selectedIndexs[i]];\r\n                // if (geometry === this.mouseState.pointTarget) {\r\n                //     continue\r\n                // }\r\n                geometry.draw(_this.canvasCtx);\r\n            }\r\n            _this.continuedRender();\r\n        });\r\n    };\r\n    Scene.prototype.rerenderWith = function (ctx, geometries) {\r\n        if (geometries === void 0) { geometries = []; }\r\n        var _geometries = geometries.length ? geometries : this.geometries;\r\n        this.clearCanvas(ctx);\r\n        for (var i = 0; i < _geometries.length; i++) {\r\n            _geometries[i].draw(ctx);\r\n        }\r\n    };\r\n    Scene.prototype.getPixCanvasData = function () {\r\n        return this.canvasCtx.getImageData(this.config.canvasRect.left, this.config.canvasRect.top, this.config.canvasRect.width, this.config.canvasRect.height);\r\n    };\r\n    Scene.prototype.rerender = function () {\r\n        this.rerenderWith(this.offScreen.cacheCanvasCtx);\r\n        this.rerenderWith(this.canvasCtx);\r\n    };\r\n    Scene.prototype.getToolState = function () {\r\n        return JSON.parse(JSON.stringify(this.toolState));\r\n    };\r\n    Scene.prototype.setToolState = function (toolState) {\r\n        this.toolState = JSON.parse(JSON.stringify(toolState));\r\n    };\r\n    Scene.prototype.setGeometryConstructor = function (geometryConstructor) {\r\n        this.geometryConstructor = geometryConstructor;\r\n    };\r\n    Scene.prototype.toggleStateToDrawing = function () {\r\n        this.config.state = ECanvasState.DRAWING;\r\n    };\r\n    Scene.prototype.toggleStateToSelect = function () {\r\n        this.config.state = ECanvasState.SELECT;\r\n    };\r\n    Scene.prototype.clearAllGeometries = function () {\r\n        // this.geometries = []\r\n        this.geometries.length = 0;\r\n    };\r\n    Scene.prototype.removeGeometry = function (index) {\r\n        if (String(+index) === 'NaN' || index < 0) {\r\n            return;\r\n        }\r\n        this.geometries.splice(index, 1);\r\n    };\r\n    Scene.prototype.addGeometry = function (geometry) {\r\n        this.geometries.push(geometry);\r\n    };\r\n    Scene.prototype.pushGeometries = function (geometries) {\r\n        var _this = this;\r\n        geometries.forEach(function (item) {\r\n            _this.geometries.push(item);\r\n        });\r\n    };\r\n    Scene.prototype.clearCanvas = function (ctx) {\r\n        ctx.clearRect(0, 0, this.config.canvasRect.width, this.config.canvasRect.height);\r\n    };\r\n    Scene.prototype.paintWith = function (ctx, sourceCanvas, x, y) {\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        ctx.drawImage(sourceCanvas, x, y, this.config.canvasRect.width, this.config.canvasRect.height);\r\n    };\r\n    Scene.prototype.findClickedTarget = function (x, y) {\r\n        var geometryTarget = null;\r\n        var geometryTargetIndex = -1;\r\n        for (var i = this.geometries.length - 1; i >= 0; i--) {\r\n            if (this.geometries[i].choose(x, y) && !geometryTarget) {\r\n                geometryTarget = this.geometries[i];\r\n                geometryTargetIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        return {\r\n            geometryTarget: geometryTarget,\r\n            geometryTargetIndex: geometryTargetIndex,\r\n        };\r\n    };\r\n    return Scene;\r\n}());\r\nexports.Scene = Scene;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BoxSelectTool = void 0;\r\nvar drawDashLine = function (ctx, _a, _b, step) {\r\n    var x1 = _a[0], y1 = _a[1];\r\n    var x2 = _b[0], y2 = _b[1];\r\n    if (step === void 0) { step = 5; }\r\n    var x = x2 - x1;\r\n    var y = y2 - y1;\r\n    var count = Math.floor(Math.sqrt(x * x + y * y) / step);\r\n    var xv = x / count;\r\n    var yv = y / count;\r\n    for (var i = 0; i < count; i++) {\r\n        if (i % 2 === 0) {\r\n            ctx.moveTo(x1, y1);\r\n        }\r\n        else {\r\n            ctx.lineTo(x1, y1);\r\n        }\r\n        x1 += xv;\r\n        y1 += yv;\r\n    }\r\n    ctx.lineTo(x2, y2);\r\n};\r\nvar BoxSelectTool = /** @class */ (function () {\r\n    function BoxSelectTool(x, y, w, h) {\r\n        this.brushConfig = {\r\n            fillStyle: 'rgba(255, 255, 255, 0)',\r\n            lineWidth: 0.5,\r\n            strokeStyle: 'rgba(0, 0, 0, 1)',\r\n        };\r\n        this.x = x;\r\n        this.y = y;\r\n        this.w = w;\r\n        this.h = h;\r\n    }\r\n    BoxSelectTool.prototype.setStartCoordinate = function (x, y) {\r\n        this.x = x + this.brushConfig.lineWidth;\r\n        this.y = y + this.brushConfig.lineWidth;\r\n    };\r\n    BoxSelectTool.prototype.restoreStatus = function () {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.w = 0;\r\n        this.h = 0;\r\n    };\r\n    BoxSelectTool.prototype.setShapeParameter = function (x, y) {\r\n        this.w = x - this.x;\r\n        this.h = y - this.y;\r\n    };\r\n    BoxSelectTool.prototype.draw = function (ctx) {\r\n        ctx.beginPath();\r\n        ctx.fillStyle = this.brushConfig.fillStyle;\r\n        ctx.strokeStyle = this.brushConfig.strokeStyle;\r\n        ctx.lineWidth = this.brushConfig.lineWidth;\r\n        this.drawDashRect(ctx, this.x, this.y, this.w, this.h);\r\n        ctx.closePath();\r\n    };\r\n    BoxSelectTool.prototype.drawDashRect = function (ctx, left, top, width, height, step) {\r\n        if (step === void 0) { step = 5; }\r\n        drawDashLine(ctx, [left, top], [left + width, top], step);\r\n        ctx.stroke();\r\n        drawDashLine(ctx, [left + width, top], [left + width, top + height], step);\r\n        ctx.stroke();\r\n        drawDashLine(ctx, [left + width, top + height], [left, top + height], step);\r\n        ctx.stroke();\r\n        drawDashLine(ctx, [left, top + height], [left, top], step);\r\n        ctx.stroke();\r\n    };\r\n    return BoxSelectTool;\r\n}());\r\nexports.BoxSelectTool = BoxSelectTool;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EEVENT_NAMESPANCE = void 0;\r\nvar EEVENT_NAMESPANCE;\r\n(function (EEVENT_NAMESPANCE) {\r\n    EEVENT_NAMESPANCE[\"DRAW_START\"] = \"DRAW_START\";\r\n    EEVENT_NAMESPANCE[\"DRAW_DOING\"] = \"DRAW_DOING\";\r\n    EEVENT_NAMESPANCE[\"DRAW_FINISHED\"] = \"DRAW_FINISHED\";\r\n    EEVENT_NAMESPANCE[\"SELECT\"] = \"SELECT\";\r\n    EEVENT_NAMESPANCE[\"CANCEL_SELECT\"] = \"CANCEL_SELECT\";\r\n    EEVENT_NAMESPANCE[\"DELETE_ONE\"] = \"DELETE_ONE\";\r\n})(EEVENT_NAMESPANCE = exports.EEVENT_NAMESPANCE || (exports.EEVENT_NAMESPANCE = {}));\r\nvar Events = /** @class */ (function () {\r\n    function Events() {\r\n        this.events = {};\r\n    }\r\n    Events.prototype.on = function (name, callback) {\r\n        if (typeof name !== 'string' || !name || typeof callback !== 'function') {\r\n            return;\r\n        }\r\n        if (!this.events[name]) {\r\n            this.events[name] = [];\r\n        }\r\n        this.events[name].push(callback);\r\n    };\r\n    Events.prototype.emit = function (name) {\r\n        if (!arguments.length || typeof name !== 'string' || !this.events[name]) {\r\n            return;\r\n        }\r\n        var params = Array.from(arguments).splice(1);\r\n        this.events[name].forEach(function (item, index) {\r\n            item.apply(void 0, params);\r\n        });\r\n    };\r\n    return Events;\r\n}());\r\nexports.default = Events;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CanvasController_1 = require(\"./Scene/CanvasController\");\r\nvar Circle_1 = require(\"./Geometies/Circle\");\r\nvar Line_1 = require(\"./Geometies/Line\");\r\nvar Rect_1 = require(\"./Geometies/Rect\");\r\nexports.default = {\r\n    CanvasContoller: CanvasController_1.CanvasContoller,\r\n    Geometry: {\r\n        Circle: Circle_1.Circle,\r\n        Line: Line_1.Line,\r\n        Rect: Rect_1.Rect,\r\n    },\r\n};\r\n"],"names":[],"sourceRoot":""}